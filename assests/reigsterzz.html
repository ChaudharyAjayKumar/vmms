<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - Satya Traders VMMS</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff; /* 70% White */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px 0;
            margin: 0;
        }
        .register-container {
            background-color: #f9f9f9;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 450px;
            text-align: center;
        }
        .logo-container {
            width: 130px; /* Adjusted for the new logo size */
            height: 130px;
            margin: 0 auto 20px auto;
        }
        h2 {
            color: #333;
            margin-bottom: 25px;
        }
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: bold;
        }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        /* UPDATED: Prevents horizontal resize of the textarea */
        .form-group textarea {
            resize: vertical;
        }
        #password-reqs {
            font-size: 13px;
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            background-color: #fef4f4;
            border-left: 4px solid #d9534f; /* Red */
            display: none; /* Initially hidden */
        }
        #password-reqs p {
            margin: 5px 0;
            color: #c9302c; /* Red text */
        }
        #password-reqs p.valid {
            color: #5cb85c; /* Green text */
            text-decoration: line-through;
        }
        .btn-register {
            width: 100%;
            padding: 15px;
            background-color: #d9534f; /* 15% Red */
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .btn-register:hover {
            background-color: #c9302c;
        }
        .footer-links {
            margin-top: 20px;
            font-size: 14px;
        }
        .footer-links a {
            color: #5cb85c; /* Green Accent */
            text-decoration: none;
        }
        .hidden-fields {
            display: none;
        }
    </style>
</head>
<body>
    <div class="register-container">
        <div class="logo-container">
             <svg class="w-full h-full" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
              <defs>
                <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" style="stop-color:#d9534f;" />
                  <stop offset="50%" style="stop-color:#f0ad4e;" />
                  <stop offset="100%" style="stop-color:#5cb85c;" />
                </linearGradient>
              </defs>
              <circle cx="100" cy="100" r="98" fill="none" stroke="#e2e8f0" stroke-width="4"/>
              <g transform="translate(100, 100)">
                <path d="M95,0 A95,95 0 0,1 0,95 A95,95 0 0,1 -95,0 A95,95 0 0,1 0,-95 A95,95 0 0,1 95,0 Z" stroke="#a0aec0" stroke-width="1.5" fill="none" stroke-dasharray="5, 5" stroke-linecap="round"/>
              </g>
              <text x="100" y="115" font-family="'Montserrat', sans-serif" font-size="64" font-weight="700" fill="url(#logoGradient)" text-anchor="middle">
                ST
              </text>
            </svg>
        </div>
        
        <h2>Create Your Account</h2>
        
        <form action="AuthServlet" method="post" onsubmit="return validateForm()">
            <input type="hidden" name="action" value="register"/>
            
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" required>
            </div>
            <div class="form-group">
                <label for="role">Select Your Role</label>
                <select id="role" name="role" onchange="toggleRoleFields()" required>
                    <option value="">--Select Role--</option>
                    <option value="Vendor">Vendor</option>
                    <option value="DeliveryPartner">Delivery Partner</option>
                    <option value="Admin">Admin</option>
                </select>
            </div>
            
            <div id="vendor-fields" class="hidden-fields">
                <div class="form-group">
                    <label for="vendorName">Company Name</label>
                    <input type="text" id="vendorName" name="vendorName">
                </div>
                <div class="form-group">
                    <label for="vendorContact">Contact Number</label>
                    <input type="text" id="vendorContact" name="vendorContact">
                </div>
                <div class="form-group">
                    <label for="address">Address</label>
                    <textarea id="address" name="address" rows="3"></textarea>
                </div>
            </div>
            
            <div id="admin-delivery-fields" class="hidden-fields">
                 <div class="form-group">
                    <label for="fullName">Full Name</label>
                    <input type="text" id="fullName" name="fullName">
                </div>
                <div class="form-group">
                    <label for="contact">Contact Number</label>
                    <input type="text" id="contact" name="contact">
                </div>
            </div>

            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" required>
                <div id="password-reqs">
                    <p id="length">At least 8 characters long</p>
                    <p id="capital">At least one uppercase letter</p>
                    <p id="special">At least one special character (!@#$%^&*)</p>
                </div>
            </div>
             <div class="form-group">
                <label for="confirmPassword">Confirm Password</label>
                <input type="password" id="confirmPassword" name="confirmPassword" required>
            </div>

            <button type="submit" class="btn-register">Register</button>
        </form>
        
        <div class="footer-links">
            Already have an account? <a href="login.jsp">Login Here</a>
        </div>
    </div>

    <script>
        // --- Password Validation Logic ---
        const passwordInput = document.getElementById('password');
        const reqsContainer = document.getElementById('password-reqs');
        
        const lengthReq = document.getElementById('length');
        const capitalReq = document.getElementById('capital');
        const specialReq = document.getElementById('special');

        passwordInput.addEventListener('focus', () => {
            reqsContainer.style.display = 'block';
        });

        let passwordIsValid = false;

        passwordInput.addEventListener('keyup', () => {
            const pass = passwordInput.value;
            let checks = { length: false, capital: false, special: false };
            
            checks.length = pass.length >= 8;
            checks.capital = /[A-Z]/.test(pass);
            checks.special = /[!@#$%^&*]/.test(pass);
            
            lengthReq.classList.toggle('valid', checks.length);
            capitalReq.classList.toggle('valid', checks.capital);
            specialReq.classList.toggle('valid', checks.special);
            
            passwordIsValid = checks.length && checks.capital && checks.special;
        });

        // --- Dynamic Role Fields Logic ---
        function toggleRoleFields() {
            const role = document.getElementById('role').value;
            const vendorFields = document.getElementById('vendor-fields');
            const otherFields = document.getElementById('admin-delivery-fields');

            vendorFields.style.display = 'none';
            otherFields.style.display = 'none';

            vendorFields.querySelectorAll('input, textarea').forEach(el => el.required = false);
            otherFields.querySelectorAll('input').forEach(el => el.required = false);
            
            if (role === 'Vendor') {
                vendorFields.style.display = 'block';
                vendorFields.querySelectorAll('input, textarea').forEach(el => el.required = true);
            } else if (role === 'Admin' || role === 'DeliveryPartner') {
                otherFields.style.display = 'block';
                otherFields.querySelectorAll('input').forEach(el => el.required = true);
            }
        }

        // --- Form Submission Validation ---
        function validateForm() {
            const password = passwordInput.value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            if (password !== confirmPassword) {
                alert('Passwords do not match!');
                return false;
            }
            
            if (!passwordIsValid) {
                 alert('Password does not meet the requirements.');
                 return false;
            }

            return true;
        }
    </script>
</body>
</html>